var TransitionableReactRouter=function(t,e){"use strict";var n="default"in e?e.default:e;const r=e.createContext();const u=[];function o(t,e="/"){return u[e]||(u[e]=new RegExp(`^/?${e}/?(.*)`,"ig")),u[e].lastIndex=-1,`/${u[e].exec(t)[1]}`}function c(t=""){return t.replace("//","/")}function i(){}const s="undefined"==typeof window,a=["entering","entered","exiting","exited"],l=[1,1,3,3];function p(t,e){if(!e)return null;for(let[n]of t.current){n.lastIndex=0;const t=n.exec(e);if(t)return t}}return t.Router=function({base:t="/",children:u}){const[c,i]=e.useState({currentRoute:o(window.location.pathname,t),previousRoute:""});return e.useEffect(()=>{function e(){i(e=>({currentRoute:`/${o(window.location.pathname,t)}`.replace("//","/"),previousRoute:e.currentRoute}))}return window.addEventListener("popstate",e),function(){window.removeEventListener("popstate",e)}},[]),n.createElement(r.Provider,{value:{setRoute:e=>{window.history.pushState({},null,e),i(e=>({currentRoute:o(window.location.pathname,t),previousRoute:e.currentRoute}))},...c}},u)},t.RouterContext=r,t.TransitionableReactRoute=function t({animateOnMount:u,children:o,onRouteChange:f=i,path:m,timeout:h=1e3,...R}){const d=Date.now(),w=e.useRef([]),g=e.useRef(h),$=e.useContext(r),x=$.currentRoute,E=`${x}_${d}`,[y,v]=e.useState(s?[{state:u?0:1,key:E,timestamp:d,currentRoute:x}]:[]);return w.current.length||n.Children.forEach(o,e=>{const{path:r,defaultpath:o}=e.props,i=e.type===t,s={...e.props,fullPath:o?"defaultpath":c(`${m||""}/${r}`),timeout:h};i&&(s.animateOnMount=u);const a=n.cloneElement(e,s);o?w.current.push([/.*/gi,[!1],a]):w.current.push(function([t,e,n],r=!1){const u=c(n?`${n}/${e}`:e),[o,i]=function(t){const e=t.split("/");return"/"===t?["^",[!1]]:e.filter(t=>!!t).reduce((t,e,n)=>{const r=t[1];return 0===e.indexOf(":")?(r.push(e.substring(1)),[`${t[0]}\\/?([^\\/]+)?`,r]):(r.push(!1),n>0?[`${t[0]}\\/(${e})`,r]:[`${t[0]}(${e})`,r])},["^\\/",[]])}(u);let s=o;return r?s=`${o}\\/.*`:"/"===e&&(s=`${o}\\/`),[new RegExp(`${s}$`,"ig"),i,t]}([a,r,m],i))}),e.useEffect(()=>{f(x),R.transitionstate!==a[2]&&v(t=>{const e=[...t],n=Date.now(),r=function(t,e,n){const r=p(n,t),u=p(n,e);return u&&r?r[r.length-1]===u[u.length-1]:null}((function(t=[]){return t[t.length-1]}(e)||{}).currentRoute,$.currentRoute,w),o=e.length-1;return e.length>0&&e[o].state<2&&!r&&(e[o]={...e[o],timestamp:n,state:2}),r||e.push({state:u?0:1,key:E,timestamp:n,currentRoute:x}),e})},[x]),e.useEffect(()=>{let t,e=!1;const n=()=>{t=requestAnimationFrame(()=>{!e&&function(t,e){t(t=>{let n=!1;const r=Date.now(),u=[...t];for(let t=0;t<u.length;t++){const o=l[u[t].state];r-u[t].timestamp>=e&&o!==u[t].state&&(n=!0,u[t]={...u[t],state:o})}return n?u.filter(({state:t})=>t<3):t})}(v,g.current),n()})};return t=n(),()=>{e=!0,cancelAnimationFrame(t)}},[]),e.useEffect(()=>{h!==g.current&&(w.current=w.current.map(([t,e,r])=>[t,e,h!==r.props.timeout?n.cloneElement(r,{timeout:h}):r]),g.current=h)},[h]),e.useMemo(()=>y.map(({currentRoute:t,key:e,state:r})=>{const u=function(t,e){t:for(let[n,r,u]of t){n.lastIndex=0;const t=n.exec(e);if(!t)continue;let o={};for(let e=0;e<r.length;e++)if("string"==typeof r[e]&&(o[r[e]]=t[e+1],!t[e+1]))continue t;return{component:u,query:o}}return{component:null,attributes:null}}(w.current,t);return u.component?n.createElement(u.component.type,{key:e,...u.component.props,query:u.query,transitionstate:a[r]}):null}),[y])},t}({},React);