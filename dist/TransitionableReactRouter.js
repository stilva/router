var TransitionableReactRouter=function(t,e){"use strict";var n="default"in e?e.default:e;const r=e.createContext();const u=[];function o(t,e="/"){return u[e]||(u[e]=new RegExp(`^/?${e}/?(.*)`,"ig")),u[e].lastIndex=-1,`/${u[e].exec(t)[1]}`}function c(t=""){return t.replace("//","/")}function s(){}const a=["entering","entered","exiting","exited"],i=[1,1,3,3];function l(t,e){if(!e)return null;for(let[n]of t.current){n.lastIndex=0;const t=n.exec(e);if(t)return t}}return t.Router=function({base:t="/",children:u}){const[c,s]=e.useState({currentRoute:o(window.location.pathname,t),previousRoute:""});return e.useEffect(()=>{function e(){s(e=>({currentRoute:`/${o(window.location.pathname,t)}`.replace("//","/"),previousRoute:e.currentRoute}))}return window.addEventListener("popstate",e),function(){window.removeEventListener("popstate",e)}},[]),n.createElement(r.Provider,{value:{setRoute:e=>{window.history.pushState({},null,`${t}/${e}`.replace(/\/\/\/?/i,"/")),s(e=>({currentRoute:o(window.location.pathname,t),previousRoute:e.currentRoute}))},...c}},u)},t.RouterContext=r,t.TransitionableReactRoute=function t({animateOnMount:u,children:o,onRouteChange:p=s,path:f,timeout:h=1e3,...m}){const R=Date.now(),d=e.useRef([]),g=e.useRef(h),$=e.useContext(r),w=$.currentRoute,x=`${w}_${R}`,[E,y]=e.useState([{state:u?0:1,key:x,timestamp:R,currentRoute:w}]);return d.current.length||n.Children.forEach(o,e=>{const{path:r,defaultpath:o}=e.props,s=e.type===t,a={...e.props,fullPath:o?"defaultpath":c(`${f||""}/${r}`),timeout:h};s&&(a.animateOnMount=u);const i=n.cloneElement(e,a);o?d.current.push([/.*/gi,[!1],i]):d.current.push(function([t,e,n],r=!1){const u=c(n?`${n}/${e}`:e),[o,s]=function(t){const e=t.split("/");return"/"===t?["^",[!1]]:e.filter(t=>!!t).reduce((t,e,n)=>{const r=t[1];return 0===e.indexOf(":")?(r.push(e.substring(1)),[`${t[0]}\\/?([^\\/]+)?`,r]):(r.push(!1),n>0?[`${t[0]}\\/(${e})`,r]:[`${t[0]}(${e})`,r])},["^\\/",[]])}(u);let a=o;return r?a=`${o}\\/.*`:"/"===e&&(a=`${o}\\/`),[new RegExp(`${a}$`,"ig"),s,t]}([i,r,f],s))}),e.useEffect(()=>{p(w),m.transitionstate!==a[2]&&y(t=>{const e=[...t],n=Date.now(),r=function(t,e,n){const r=l(n,t),u=l(n,e);return u&&r?r[r.length-1]===u[u.length-1]:null}((function(t=[]){return t[t.length-1]}(e)||{}).currentRoute,$.currentRoute,d),o=[],c=e.length-1;return e.length>0&&e[c].state<2&&!r&&(o.push(c),e[c]={...e[c],timestamp:n,state:2}),r||(o.push(e.length),e.push({state:u?0:1,key:x,timestamp:n,currentRoute:w})),o.length?e:t})},[w]),e.useEffect(()=>{let t,e=!1;const n=()=>{t=requestAnimationFrame(()=>{!e&&function(t,e){t(t=>{let n=!1;const r=Date.now(),u=[];for(let o=0;o<t.length;o++){const c=i[t[o].state];r-t[o].timestamp>=e&&c!==t[o].state?(n=!0,c<3&&u.push({...t[o],state:c})):t[o].state<3&&u.push(t[o])}return n?u:t})}(y,g.current),n()})};return t=n(),()=>{e=!0,cancelAnimationFrame(t)}},[]),e.useEffect(()=>{h!==g.current&&(d.current=d.current.map(([t,e,r])=>[t,e,h!==r.props.timeout?n.cloneElement(r,{timeout:h}):r]),g.current=h)},[h]),e.useMemo(()=>E.map(({currentRoute:t,key:e,state:r})=>{const u=function(t,e){t:for(let[n,r,u]of t){n.lastIndex=0;const t=n.exec(e);if(!t)continue;let o={};for(let e=0;e<r.length;e++)if("string"==typeof r[e]&&(o[r[e]]=t[e+1],!t[e+1]))continue t;return{component:u,query:o}}return{component:null,attributes:null}}(d.current,t);return u.component?n.createElement(u.component.type,{key:e,...u.component.props,query:u.query,transitionstate:a[r]}):null}),[E])},t}({},React);