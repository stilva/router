var TransitionableReactRouter=function(t,e){"use strict";var n="default"in e?e.default:e;const r=e.createContext();const u="undefined"==typeof window,o=["entering","entered","exiting","exited"],c=[1,1,3,3];function i(t,e){if(!e)return null;for(let[n]of t.current){n.lastIndex=0;const t=n.exec(e);if(t)return t}}function a(t=""){return t.replace("//","/")}function s(){}return t.Router=function({children:t}){const[u,o]=e.useState({currentRoute:window.location.pathname,previousRoute:""});return e.useEffect(()=>{function t(){o(t=>({currentRoute:`/${window.location.pathname}`.replace("//","/"),previousRoute:t.currentRoute}))}return window.addEventListener("popstate",t),function(){window.removeEventListener("popstate",t)}},[]),n.createElement(r.Provider,{value:{setRoute:t=>{window.history.pushState({},null,t),o(t=>({currentRoute:window.location.pathname,previousRoute:t.currentRoute}))},...u}},t)},t.RouterContext=r,t.TransitionableReactRoute=function t({animateOnMount:l,children:p,onRouteChange:f=s,path:m,timeout:h=1e3,...R}){const d=Date.now(),w=e.useRef([]),g=e.useRef(h),$=e.useContext(r),y=$.currentRoute,E=`${y}_${d}`,[x,v]=e.useState(u?[{state:l?0:1,key:E,timestamp:d,currentRoute:y}]:[]);return w.current.length||n.Children.forEach(p,e=>{const{path:r,defaultpath:u}=e.props,o=e.type===t,c={...e.props,fullPath:u?"defaultpath":a(`${m||""}/${r}`),timeout:h};o&&(c.animateOnMount=l);const i=n.cloneElement(e,c);u?w.current.push([/.*/gi,[!1],i]):w.current.push(function([t,e,n],r=!1){const u=a(n?`${n}/${e}`:e),[o,c]=function(t){const e=t.split("/");return"/"===t?["^",[!1]]:e.filter(t=>!!t).reduce((t,e,n)=>{const r=t[1];return 0===e.indexOf(":")?(r.push(e.substring(1)),[`${t[0]}\\/?([^\\/]+)?`,r]):(r.push(!1),n>0?[`${t[0]}\\/(${e})`,r]:[`${t[0]}(${e})`,r])},["^\\/",[]])}(u);let i=o;return r?i=`${o}\\/.*`:"/"===e&&(i=`${o}\\/`),[new RegExp(`${i}$`,"ig"),c,t]}([i,r,m],o))}),e.useEffect(()=>{f(y),R.transitionstate!==o[2]&&v(t=>{const e=[...t],n=Date.now(),r=function(t,e,n){const r=i(n,t),u=i(n,e);return u&&r?r[r.length-1]===u[u.length-1]:null}((function(t=[]){return t[t.length-1]}(e)||{}).currentRoute,$.currentRoute,w),u=e.length-1;return e.length>0&&e[u].state<2&&!r&&(e[u]={...e[u],timestamp:n,state:2}),r||e.push({state:l?0:1,key:E,timestamp:n,currentRoute:y}),e})},[y]),e.useEffect(()=>{let t,e=!1;const n=()=>{t=requestAnimationFrame(()=>{!e&&function(t,e){t(t=>{let n=!1;const r=Date.now(),u=[...t];for(let t=0;t<u.length;t++){const o=c[u[t].state];r-u[t].timestamp>=e&&o!==u[t].state&&(n=!0,u[t]={...u[t],state:o})}return n?u.filter(({state:t})=>t<3):t})}(v,g.current),n()})};return t=n(),()=>{e=!0,cancelAnimationFrame(t)}},[]),e.useEffect(()=>{h!==g.current&&(w.current=w.current.map(([t,e,r])=>[t,e,h!==r.props.timeout?n.cloneElement(r,{timeout:h}):r]),g.current=h)},[h]),e.useMemo(()=>x.map(({currentRoute:t,key:e,state:r})=>{const u=function(t,e){t:for(let[n,r,u]of t){n.lastIndex=0;const t=n.exec(e);if(!t)continue;let o={};for(let e=0;e<r.length;e++)if("string"==typeof r[e]&&(o[r[e]]=t[e+1],!t[e+1]))continue t;return{component:u,query:o}}return{component:null,attributes:null}}(w.current,t);return u.component?n.createElement(u.component.type,{key:e,...u.component.props,query:u.query,transitionstate:o[r]}):null}),[x])},t}({},React);